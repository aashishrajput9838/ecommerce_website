<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delete File</title>
</head>
<body>
    <h1>Delete a Text File</h1>
    <h2>Available Files:</h2>
    <ul id="fileList"></ul>

    <script>
        async function loadFiles() {
            try {
                const response = await fetch('http://localhost:3000/api/files');
                const result = await response.json();
                const fileList = document.getElementById('fileList');
                fileList.innerHTML = '';
                if (result.files && result.files.length > 0) {
                    result.files.forEach(file => {
                        const li = document.createElement('li');
                        li.style.display = 'flex';
                        li.style.alignItems = 'center';
                        // File name
                        const span = document.createElement('span');
                        span.textContent = file;
                        span.style.marginRight = '10px';
                        li.appendChild(span);
                        // Delete button
                        const deleteBtn = document.createElement('button');
                        deleteBtn.textContent = 'Delete';
                        deleteBtn.onclick = () => deleteFile(file);
                        li.appendChild(deleteBtn);
                        fileList.appendChild(li);
                    });
                } else {
                    fileList.innerHTML = '<li>No files found.</li>';
                }
            } catch (error) {
                document.getElementById('fileList').innerHTML = '<li>Error loading files.</li>';
            }
        }

        async function deleteFile(fileName) {
            if (!confirm(`Are you sure you want to delete ${fileName}?`)) return;
            try {
                const response = await fetch('http://localhost:3000/api/delete', {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ fileName })
                });
                const result = await response.json();
                if (response.ok) {
                    alert(result.message);
                    loadFiles();
                } else {
                    alert(result.error);
                }
            } catch (error) {
                alert('Error connecting to server.');
            }
        }

        window.onload = loadFiles;
    </script>
</body>
</html>